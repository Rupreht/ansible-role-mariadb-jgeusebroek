---
- hosts: all

  vars:
    mariadb_version: 10.2

  pre_tasks:
    - name: Ensure gnupg is installed on Debian 9 (Stretch)
      package:
        name: gnupg
        state: installed
      changed_when: False
      when: ansible_distribution_release == 'stretch'

    - name: Fix (#1) some weird overlayFS bug with TravisCI
      file:
        path: /var/lib/rpm/*
        state: touch
      changed_when: False
      when: ansible_os_family == 'RedHat'

    - name: Fix (#2) some weird overlayFS bug with TravisCI
      shell: "yum clean all && rpm --rebuilddb"
      changed_when: false
      when: ansible_os_family == 'RedHat'
      tags: skip_ansible_lint

    - name: Ensure apt-utils is installed on Ubuntu | Debian / Ubuntu
      package:
        name: apt-utils
        state: installed
      changed_when: False
      when: ansible_os_family == 'Debian'

  roles:
    - role: jgeusebroek.mariadb
